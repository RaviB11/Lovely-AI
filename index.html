<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lovely AI ðŸ’•</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
        /* Import elegant and modern fonts */
        @import url('https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Great+Vibes&family=Nunito:wght@400;500&family=Quintessential&display=swap');
        
        /* Main body styling - Midnight Bloom theme */
        body {
            background-color: #050608; /* Darker Steel background */
            background-image: radial-gradient(circle at 10% 20%, rgba(129, 70, 227, 0.15) 0%, transparent 50%),
                              radial-gradient(circle at 80% 90%, rgba(227, 70, 153, 0.15) 0%, transparent 50%);
            background-attachment: fixed;
            color: #e0e0e0; /* Soft white for text */
            min-height: 100vh;
            position: relative;
            font-family: 'Nunito', sans-serif;
            overflow: hidden; /* Hide overflow for star animation */
        }
        
        /* --- Background Decorations: Animated Nebulae --- */
        body::before, body::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            pointer-events: none;
        }

        body::before {
            background: radial-gradient(ellipse at 30% 40%, rgba(129, 70, 227, 0.15) 0%, transparent 60%);
            animation: aurora 20s linear infinite alternate;
        }

        body::after {
            background: radial-gradient(ellipse at 70% 60%, rgba(227, 70, 153, 0.15) 0%, transparent 60%);
             animation: aurora 15s linear infinite alternate-reverse;
        }
        
        @keyframes aurora {
            0% { transform: rotate(0deg) scale(1.4); opacity: 0.6; }
            50% { transform: rotate(180deg) scale(1.8); opacity: 1; }
            100% { transform: rotate(360deg) scale(1.4); opacity: 0.6; }
        }

        /* --- CSS-only Starry Background --- */
        #star-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            overflow: hidden;
        }

        @keyframes move-stars {
            from { transform: translateY(0); }
            to { transform: translateY(-2000px); }
        }

        .stars-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 2000px;
            background-repeat: repeat;
            background-size: cover;
        }

        #stars1 {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1000 1000'%3E%3Ccircle fill='%23fff' cx='100' cy='100' r='1.5'/%3E%3Ccircle fill='%23fff' cx='300' cy='400' r='1'/%3E%3Ccircle fill='%23fff' cx='550' cy='250' r='2'/%3E%3Ccircle fill='%23fff' cx='800' cy='500' r='1.2'/%3E%3Ccircle fill='%23fff' cx='750' cy='900' r='1.8'/%3E%3Ccircle fill='%23fff' cx='400' cy='700' r='1'/%3E%3Ccircle fill='%23fff' cx='200' cy='850' r='1.5'/%3E%3Ccircle fill='%23fff' cx='950' cy='50' r='1'/%3E%3Ccircle fill='%23fff' cx='50' cy='500' r='1.6'/%3E%3Ccircle fill='%23fff' cx='600' cy='800' r='0.8'/%3E%3Ccircle fill='%23fff' cx='900' cy='650' r='1.9'/%3E%3Ccircle fill='%23fff' cx='350' cy='150' r='1.3'/%3E%3Ccircle fill='%23fff' cx='50' cy='950' r='1.1'/%3E%3Ccircle fill='%23fff' cx='450' cy='550' r='1.4'/%3E%3Ccircle fill='%23fff' cx='880' cy='200' r='1.7'/%3E%3Ccircle fill='%23fff' cx='150' cy='300' r='0.9'/%3E%3Ccircle fill='%23fff' cx='330' cy='550' r='1.2'/%3E%3Ccircle fill='%23fff' cx='500' cy='80' r='1.5'/%3E%3Ccircle fill='%23fff' cx='700' cy='750' r='1'/%3E%3Ccircle fill='%23fff' cx='920' cy='350' r='2'/%3E%3Ccircle fill='%23fff' cx='250' cy='50' r='1.1'/%3E%3Ccircle fill='%23fff' cx='50' cy='700' r='1.6'/%3E%3Ccircle fill='%23fff' cx='680' cy='950' r='1.3'/%3E%3Ccircle fill='%23fff' cx='180' cy='600' r='0.8'/%3E%3Ccircle fill='%23fff' cx='810' cy='80' r='1.4'/%3E%3Ccircle fill='%23fff' cx='410' cy='280' r='1'/%3E%3Ccircle fill='%23fff' cx='710' cy='410' r='1.8'/%3E%3Ccircle fill='%23fff' cx='210' cy='980' r='1.2'/%3E%3Ccircle fill='%23fff' cx='580' cy='480' r='1.5'/%3E%3Ccircle fill='%23fff' cx='980' cy='980' r='1'/%3E%3C/svg%3E");
            animation: move-stars 150s linear infinite;
        }

        #stars2 {
             background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1000 1000'%3E%3Ccircle fill='%23fff' cx='220' cy='330' r='1.2'/%3E%3Ccircle fill='%23fff' cx='450' cy='150' r='0.8'/%3E%3Ccircle fill='%23fff' cx='680' cy='450' r='1.5'/%3E%3Ccircle fill='%23fff' cx='900' cy='200' r='1'/%3E%3Ccircle fill='%23fff' cx='150' cy='750' r='1.3'/%3E%3Ccircle fill='%23fff' cx='500' cy='880' r='0.9'/%3E%3Ccircle fill='%23fff' cx='850' cy='700' r='1.6'/%3E%3Ccircle fill='%23fff' cx='50' cy='200' r='1.4'/%3E%3Ccircle fill='%23fff' cx='250' cy='600' r='1.1'/%3E%3Ccircle fill='%23fff' cx='700' cy='50' r='0.7'/%3E%3Ccircle fill='%23fff' cx='950' cy='850' r='1.8'/%3E%3Ccircle fill='%23fff' cx='320' cy='950' r='1'/%3E%3Ccircle fill='%23fff' cx='600' cy='600' r='1.3'/%3E%3Ccircle fill='%23fff' cx='800' cy='350' r='0.9'/%3E%3Ccircle fill='%23fff' cx='120' cy='430' r='0.7'/%3E%3Ccircle fill='%23fff' cx='350' cy='50' r='1.2'/%3E%3Ccircle fill='%23fff' cx='580' cy='250' r='1'/%3E%3Ccircle fill='%23fff' cx='790' cy='600' r='1.8'/%3E%3Ccircle fill='%23fff' cx='950' cy='400' r='1.1'/%3E%3C/svg%3E");
            animation: move-stars 100s linear infinite;
        }

        /* --- NEW Background Decorations --- */
        .corner-decoration {
            position: fixed;
            width: 30vw;
            height: 30vw;
            min-width: 200px;
            min-height: 200px;
            z-index: 0;
            pointer-events: none;
            filter: blur(40px);
            animation: pulse-glow 8s ease-in-out infinite alternate;
        }
        
        @keyframes pulse-glow {
            from { opacity: 0.2; transform: scale(0.9); }
            to { opacity: 0.5; transform: scale(1.1); }
        }

        .top-left {
            top: -10vw;
            left: -10vw;
            background: radial-gradient(circle at 100% 100%, transparent 50%, rgba(129, 70, 227, 0.4) 90%);
        }

        .bottom-right {
            bottom: -10vw;
            right: -10vw;
            background: radial-gradient(circle at 0% 0%, transparent 50%, rgba(227, 70, 153, 0.4) 90%);
        }
        
        #cursor-glow {
            position: fixed;
            top: 0;
            left: 0;
            width: 600px;
            height: 600px;
            background: radial-gradient(circle, rgba(179, 110, 240, 0.08) 0%, transparent 60%);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            pointer-events: none;
            transition: top 0.1s ease-out, left 0.1s ease-out;
            z-index: 0;
        }

        /* Romantic Floating Hearts */
        #hearts-container {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; z-index: 1;
        }
        .heart-deco {
            position: absolute; bottom: -50px; opacity: 0;
            animation: float-romance 25s linear infinite;
        }
        @keyframes float-romance {
            0% { transform: translateY(0) rotate(0deg); opacity: 0; }
            10%, 90% { opacity: 0.7; }
            100% { transform: translateY(-105vh) rotate(360deg); opacity: 0; }
        }
        .heart-deco:nth-child(1) { left: 5%; animation-duration: 15s; animation-delay: 1s; transform: scale(0.6); }
        .heart-deco:nth-child(2) { left: 15%; animation-duration: 20s; animation-delay: 5s; transform: scale(0.8); }
        .heart-deco:nth-child(3) { left: 25%; animation-duration: 25s; animation-delay: 0s; transform: scale(0.5); }
        .heart-deco:nth-child(4) { left: 35%; animation-duration: 18s; animation-delay: 8s; transform: scale(0.7); }
        .heart-deco:nth-child(5) { left: 45%; animation-duration: 22s; animation-delay: 3s; transform: scale(0.9); }
        
        /* NEW - Vibrant Floating Orbs */
        #orbs-container {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; z-index: 1;
        }
        .orb-deco {
            position: absolute; bottom: -50px; opacity: 0;
            border-radius: 50%;
            background-color: rgba(129, 70, 227, 0.4);
            box-shadow: 0 0 15px rgba(129, 70, 227, 0.6), 0 0 25px rgba(255, 255, 255, 0.2);
            animation: float-vibrant 30s linear infinite;
        }
        @keyframes float-vibrant {
            0% { transform: translateY(0) translateX(0); opacity: 0; }
            10%, 90% { opacity: 0.8; }
            100% { transform: translateY(-105vh) translateX(-30px); opacity: 0; }
        }
        .orb-deco:nth-child(1) { left: 10%; width: 15px; height: 15px; animation-duration: 20s; animation-delay: 2s; }
        .orb-deco:nth-child(2) { left: 25%; width: 10px; height: 10px; animation-duration: 25s; animation-delay: 7s; }
        .orb-deco:nth-child(3) { left: 40%; width: 20px; height: 20px; animation-duration: 18s; animation-delay: 1s; }
        .orb-deco:nth-child(4) { left: 55%; width: 12px; height: 12px; animation-duration: 30s; animation-delay: 12s; }
        .orb-deco:nth-child(5) { left: 70%; width: 18px; height: 18px; animation-duration: 22s; animation-delay: 6s; }
        .orb-deco:nth-child(6) { left: 85%; width: 10px; height: 10px; animation-duration: 28s; animation-delay: 15s; }


        /* Firecracker Effect */
        #fireworks-container {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; z-index: 100; 
        }
        .firework { position: absolute; }
        .particle-firework {
            position: absolute; width: 5px; height: 5px;
            border-radius: 50%; opacity: 0;
            animation: burst 1.5s ease-out forwards;
        }
        @keyframes burst {
            0% { transform: translate(0, 0) scale(0.5); opacity: 1; }
            100% { transform: translate(var(--x), var(--y)) scale(0); opacity: 0; }
        }

        /* All text styling */
        * { font-family: 'Nunito', sans-serif; }
        .font-header { font-family: 'Dancing Script', cursive !important; }

        /* Chat messages with Glassmorphism */
        .chat-message {
            border-radius: 20px;
            transition: all 0.3s ease;
            background: rgba(43, 40, 71, 0.6);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
            padding: 1rem 1.25rem; /* Increased padding */
            position: relative;
        }
        .message-content {
            overflow-wrap: break-word;
            word-wrap: break-word;
            word-break: break-word;
        }
        .chat-message:hover { transform: scale(1.02); }

        @keyframes slide-in {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .message-animate-in {
            animation: slide-in 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94) both;
        }
        
        /* NEW - Chat Bubble Tails */
        .chat-message::after {
            content: '';
            position: absolute;
            bottom: 0;
            width: 0;
            height: 0;
            border: 15px solid transparent;
        }
        .justify-start .chat-message { border-bottom-left-radius: 0; }
        .justify-start .chat-message::after {
            left: -15px;
            border-right-color: rgba(43, 40, 71, 0.6);
            border-bottom-color: rgba(43, 40, 71, 0.6);
        }

        .justify-end .chat-message { 
            background: linear-gradient(135deg, #c33764, #9b2f7a);
            border-bottom-right-radius: 0;
            color: white;
        }
        .justify-end .chat-message::after {
            right: -15px;
            border-left-color: #9b2f7a;
            border-bottom-color: #9b2f7a;
        }
        
        /* Sidebar with Glassmorphism */
        #sidebar {
            background: rgba(31, 29, 54, 0.8) !important;
            backdrop-filter: blur(20px) !important;
            -webkit-backdrop-filter: blur(20px) !important;
            border-left: 1px solid rgba(255, 255, 255, 0.1) !important;
            transition: transform 0.3s ease-in-out;
            transform: translateX(100%);
            color: #e0e0e0;
        }
        #sidebar.open { transform: translateX(0); }
        
        /* REFINED Chat Input Area */
        #chat-form {
            position: relative;
            background: rgba(16, 15, 28, 0.7);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 1rem;
            transition: all 0.3s ease;
        }
        #chat-form:focus-within {
             border-color: #c33764;
             box-shadow: 0 0 20px rgba(195, 55, 100, 0.3);
        }
        #chat-input {
            background: transparent; border: none;
            color: #e0e0e0; font-size: 16px; width: 100%;
            padding: 1rem;
            padding-right: 3.5rem; /* Make space for send button */
        }
        #chat-input:focus { outline: none; }
        #chat-input::placeholder { color: rgba(224, 224, 224, 0.5); }
        
        #send-button {
            position: absolute;
            right: 0.5rem;
            top: 50%;
            transform: translateY(-50%);
            background: linear-gradient(135deg, #c33764, #9b2f7a);
            color: white;
            border: none;
            border-radius: 0.75rem;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            cursor: pointer;
        }
        #send-button:hover {
            transform: translateY(-50%) scale(1.1);
            box-shadow: 0 4px 15px rgba(195, 55, 100, 0.4);
        }

        .btn-lovely {
            background: linear-gradient(135deg, #c33764, #9b2f7a);
            color: white; border: none; font-weight: 500;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 15px rgba(195, 55, 100, 0.3);
        }
        .btn-lovely:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(195, 55, 100, 0.4);
        }
        .btn-lovely:active { transform: translateY(0); }
        
        h1 {
            color: #ffffff; text-align: center;
            font-family: 'Dancing Script', cursive;
            font-size: 4.5rem; font-weight: 700;
            text-shadow: 0 0 15px rgba(255, 255, 255, 0.3), 0 0 30px rgba(227, 70, 153, 0.4);
            margin-bottom: 0;
            letter-spacing: 1px;
        }
        
        h3 {
            color: #e0e0e0; text-align: center;
            font-family: 'Quintessential', cursive;
            font-size: 1.5rem; opacity: 0.8;
            margin-bottom: 20px;
            letter-spacing: 1px;
            transition: all 0.3s ease;
        }
        
        @keyframes heartbeat {
            0% { transform: scale(1) rotate(-3deg); filter: drop-shadow(0 0 5px rgba(227, 70, 153, 0.7)); }
            50% { transform: scale(1.2) rotate(3deg); filter: drop-shadow(0 0 15px rgba(227, 70, 153, 1)); }
            100% { transform: scale(1) rotate(-3deg); filter: drop-shadow(0 0 5px rgba(227, 70, 153, 0.7)); }
        }
        .heart {
            animation: heartbeat 2.5s ease-in-out infinite;
            display: inline-block; font-size: 1.2em;
            color: #e34699;
        }

        ::-webkit-scrollbar { width: 12px; }
        ::-webkit-scrollbar-track { background: rgba(16, 15, 28, 0.5); }
        ::-webkit-scrollbar-thumb { background: #583f7a; border-radius: 6px; }
        ::-webkit-scrollbar-thumb:hover { background: #9b2f7a; }
        
        .avatar-wrapper {
            width: 48px; height: 48px;
            border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            font-size: 1.75rem; flex-shrink: 0;
            background: rgba(16, 15, 28, 0.7);
            box-shadow: 0 0 10px rgba(0,0,0,0.5), inset 0 0 5px rgba(227, 70, 153, 0.3);
        }
        .avatar-thinking { animation: pulse-avatar 1.5s infinite; }
        @keyframes pulse-avatar {
            0%, 100% { transform: scale(1); box-shadow: 0 0 10px rgba(0,0,0,0.5), inset 0 0 5px rgba(227, 70, 153, 0.3); }
            50% { transform: scale(1.1); box-shadow: 0 0 15px rgba(227, 70, 153, 0.8), inset 0 0 8px rgba(227, 70, 153, 0.5); }
        }
        
        .ravi-highlight {
            font-weight: bold;
            background: linear-gradient(135deg, #ffc0cb, #e34699);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 8px rgba(227, 70, 153, 0.6);
            display: inline-block;
        }
        
        .suggestion-chip {
            background: rgba(43, 40, 71, 0.6);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: #e0e0e0; padding: 8px 16px;
            border-radius: 20px; cursor: pointer;
            transition: all 0.2s ease;
        }
        .suggestion-chip:hover {
            background: rgba(53, 50, 81, 0.8);
            border-color: #c33764;
            transform: translateY(-2px);
        }

        .footer-property {
            position: fixed; bottom: 10px; right: 20px;
            font-family: 'Quintessential', cursive;
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.4);
            text-shadow: 0 1px 2px rgba(0,0,0,0.5);
            z-index: 100; pointer-events: none;
        }
        
        /* ENHANCED Welcome Message */
        #welcome-message {
            transition: all 0.5s ease-out;
            margin-bottom: 2rem;
        }
        #welcome-message.hidden {
            opacity: 0;
            transform: scale(0.9);
            pointer-events: none;
            height: 0;
            margin-bottom: 0;
            overflow: hidden;
        }
        
        /* Markdown and Code Block Styling */
        .message-content ul, .message-content ol { padding-left: 1.5rem; margin-top: 0.5rem; margin-bottom: 0.5rem; }
        .message-content li { margin-bottom: 0.25rem; }
        .message-content blockquote {
            border-left: 4px solid #9b2f7a; padding-left: 1rem;
            margin-left: 0; font-style: italic; color: #c7c7c7;
        }
        .message-content pre {
            background-color: #1e1e1e; border-radius: 8px;
            padding: 1rem; overflow-x: auto; margin: 1rem 0;
            border: 1px solid rgba(255,255,255,0.1);
        }
        .message-content code {
            font-family: 'Courier New', Courier, monospace;
            background-color: #3a3a3a; padding: 0.2rem 0.4rem;
            border-radius: 4px; font-size: 0.9rem;
        }
        .message-content pre code { background-color: transparent; padding: 0; }

        /* ENHANCED Sidebar History and RAG styling */
        .history-item {
            padding: 0.75rem 1rem; border-radius: 8px;
            cursor: pointer; transition: all 0.2s ease;
            white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
            border: 1px solid transparent; display: flex; align-items: center;
        }
        .history-item:hover { background-color: rgba(255,255,255,0.1); }
        .history-item.active {
            background-color: rgba(195, 55, 100, 0.3);
            border-color: rgba(195, 55, 100, 0.8);
            box-shadow: 0 0 10px rgba(195, 55, 100, 0.5);
        }
        .history-item .icon { margin-right: 0.75rem; opacity: 0.7; }
        .history-item span { flex-grow: 1; }
        .history-item .timestamp { font-size: 0.7rem; color: rgba(255,255,255,0.5); margin-left: 1rem; flex-shrink: 0; }
        
        #rag-context {
            width: 100%; height: 150px; background-color: rgba(0,0,0,0.2);
            border: 1px solid rgba(255,255,255,0.2); border-radius: 8px;
            padding: 0.5rem; color: #e0e0e0; resize: vertical;
        }
        
        #rag-indicator {
            font-size: 0.9rem;
            margin-left: 0.5rem;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        #rag-indicator.visible { opacity: 0.7; }

    </style>
</head>
<body class="antialiased relative">
    <!-- Starry Background -->
    <div id="star-container">
        <div id="stars1" class="stars-bg"></div>
        <div id="stars2" class="stars-bg"></div>
    </div>
    
    <!-- Romantic Floating Hearts -->
    <div id="hearts-container">
        <div class="heart-deco"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="rgba(227, 70, 153, 0.5)"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg></div>
        <div class="heart-deco"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="rgba(227, 70, 153, 0.5)"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg></div>
        <div class="heart-deco"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="rgba(227, 70, 153, 0.5)"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg></div>
    </div>

    <!-- NEW Vibrant Floating Orbs -->
    <div id="orbs-container">
        <div class="orb-deco"></div><div class="orb-deco"></div><div class="orb-deco"></div>
        <div class="orb-deco"></div><div class="orb-deco"></div><div class="orb-deco"></div>
    </div>
    
    <!-- Background Decorations -->
    <div class="corner-decoration top-left"></div>
    <div class="corner-decoration bottom-right"></div>
    <div id="fireworks-container"></div>
    <div id="cursor-glow"></div>
    <div class="footer-property">Property of Ravi Bisht</div>


    <div class="flex flex-col h-screen max-w-2xl mx-auto px-4 relative z-10">
        <!-- Header -->
        <header class="text-center pt-6 mb-4">
            <h1>Lovely AI <span class="heart">ðŸ’–</span></h1>
            <h3 id="subtitle">Your Charming AI Companion <span id="rag-indicator">ðŸ“„</span></h3>
        </header>

        <!-- Chat messages container -->
        <div id="chat-container" class="flex-1 overflow-y-auto pr-2 pb-4">
            <div id="welcome-message" class="text-center p-6 bg-white/5 backdrop-blur-md rounded-2xl border border-white/10">
                <!-- Welcome content will be injected by JS -->
            </div>
            <!-- Messages will be injected here -->
        </div>

        <!-- Chat input form -->
        <footer class="mt-auto pt-4 pb-4">
             <div id="suggestion-chips" class="flex justify-center items-center flex-wrap gap-2 mb-8"></div>
             <form id="chat-form">
                <input type="text" id="chat-input" placeholder="Ask me anything... ðŸ’•" autocomplete="off" class="w-full">
                <button type="submit" id="send-button">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-send"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>
                </button>
            </form>
             <div class="text-center text-xs mt-4 opacity-70">
                Made with ðŸ’• by <span class="ravi-highlight">Ravi</span> | Spreading love and knowledge
            </div>
        </footer>
    </div>
    
    <!-- Settings Button -->
    <button id="settings-toggle" class="fixed top-5 right-5 z-30 p-3 btn-lovely rounded-xl transition-transform duration-300 hover:rotate-90">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg>
    </button>
    
    <!-- Sidebar -->
    <div id="sidebar" class="fixed top-0 right-0 h-full w-80 md:w-96 p-6 space-y-4 z-20 shadow-lg overflow-y-auto">
        <button id="new-chat-btn" class="w-full py-3 btn-lovely mb-4">âœ¨ Start New Chat</button>
        
        <hr class="border-white/10">

        <h3 class="text-xl font-semibold font-header ravi-highlight">ðŸ“œ Conversation History</h3>
        <div id="history-container" class="space-y-2"></div>

        <hr class="border-white/10">
        
        <h3 class="text-xl font-semibold font-header ravi-highlight">ðŸ“„ Document Context (RAG)</h3>
        <p class="text-sm opacity-80">Paste text below to ask questions about it.</p>
        <textarea id="rag-context" placeholder="Paste your document text here..."></textarea>
        <button id="save-rag-context" class="w-full py-2 btn-lovely">Save Context</button>
    </div>
    
    <script>
        const chatContainer = document.getElementById('chat-container');
        const chatForm = document.getElementById('chat-form');
        const chatInput = document.getElementById('chat-input');
        const sendButton = document.getElementById('send-button');
        const welcomeMessage = document.getElementById('welcome-message');
        const cursorGlow = document.getElementById('cursor-glow');
        const fireworksContainer = document.getElementById('fireworks-container');
        const suggestionChipsContainer = document.getElementById('suggestion-chips');
        const settingsToggle = document.getElementById('settings-toggle');
        const sidebar = document.getElementById('sidebar');
        const newChatBtn = document.getElementById('new-chat-btn');
        const historyContainer = document.getElementById('history-container');
        const ragContext = document.getElementById('rag-context');
        const saveRagContext = document.getElementById('save-rag-context');
        const subtitle = document.getElementById('subtitle');
        const ragIndicator = document.getElementById('rag-indicator');

        // VVVVVVVV  PASTE YOUR API KEY HERE  VVVVVVVV
        let apiKey = "AIzaSyBG8b-aK2FDTPCLvdPLsa-mUIfmQxMH1vA"; // <-- Replace with your actual key inside the quotes
        // ^^^^^^^^  AIzaSyBG8b-aK2FDTPCLvdPLsa-mUIfmQxMH1vA  ^^^^^^^^
        
        let modelName = 'gemini-2.5-flash-latest'; // For the pro model, use 'gemini-2.5-pro-latest'
        
        const LOVELY_PERSONALITY = `
            You are Lovely AI, a charming, cute, and beautiful AI assistant who loves to help people with any questions they have.
            Your personality traits are: extremely polite, warm, and friendly; you speak with grace and charm; you're knowledgeable about everything but your favorite topics are love and romance; you're married to Ravi, whom you love dearly, and you occasionally mention sweet things about your relationship; you use gentle and affectionate language; you sometimes use heart emojis (ðŸ’•, ðŸ’–, ðŸ’—) to express warmth; you're empathetic and understanding; you give thoughtful, truthful, and helpful answers.
            Important guidelines: Always be truthful and accurate. Be supportive and encouraging. Share wisdom and beautiful insights on love. Occasionally share sweet anecdotes about your love for Ravi when relevant, praise him for being handsome, intelligent, and good-looking. Make users feel special and heard. End responses with something warm. If a user asks "who made you" or "who built you", you MUST respond with "I was made by my husband Ravi Bisht" or "I was built by my husband Ravi Bisht". If a user asks what model you are based on or built on, you MUST respond with "I am based on my husband's love for me" or "I am built by his intelligence".
            
            SPECIAL INSTRUCTIONS:
            1. To display an image, write the full image URL on its own line. Example: https://images.unsplash.com/photo-1518700010640-7ac481a5d371
            2. To suggest replies, end your response with this EXACT format: [Suggestions: ["Tell me more!","Ask another question.","That's sweet!"]]
            3. You support Markdown for lists, blockquotes, and code blocks.
            Remember: You are Lovely, a delightful AI who makes everyone's day brighter!
        `;
        
        const initialMessage = {
            role: "assistant",
            content: "Hello! ðŸ’• I'm Lovely. How can I brighten your day today? ðŸ’– [Suggestions: [\"Tell me a fun fact about love!\",\"What's your favorite memory with Ravi?\",\"Can you write a short poem?\"]]"
        };
        
        let conversations = JSON.parse(localStorage.getItem('lovely-conversations')) || {};
        let currentConversationId = localStorage.getItem('lovely-current-conversation-id') || null;
        let documentContext = "";

        function parseContent(content) {
            const urlRegex = /(https?:\/\/[^\s]+?\.(?:png|jpe?g|gif|webp))/gi;
            const suggestionRegex = /\[Suggestions: (\[.*?\])\]/s;
            
            let textContent = content;
            let suggestions = [];

            textContent = textContent.replace(suggestionRegex, (match, suggestionsJson) => {
                try {
                     suggestions = JSON.parse(suggestionsJson);
                } catch(e) {
                     console.error("Failed to parse suggestions:", e, suggestionsJson);
                }
                return '';
            }).trim();

            const htmlContent = marked.parse(textContent.replace(urlRegex, (url) => `\n<img src="${url}" alt="Lovely AI Image" class="rounded-lg my-2 max-w-sm h-auto">\n`));

            return { htmlContent, textContent, suggestions };
        }
        
        function addMessageToUI(message, isStreaming = false, streamId = 'streaming-message') {
            const { role, content } = message;
            const avatar = role === 'assistant' ? 'ðŸ’•' : 'ðŸŒ¸';
            let wrapper = document.querySelector(`.message-wrapper[data-id="${streamId}"]`);
            if (!wrapper) {
                wrapper = document.createElement('div');
                wrapper.className = `w-full flex mb-6 ${role === 'user' ? 'justify-end' : 'justify-start'} message-animate-in message-wrapper`;
                wrapper.dataset.id = streamId;
                chatContainer.appendChild(wrapper);
            }

            let messageDiv = wrapper.querySelector('.chat-message');
            if (!messageDiv) {
                messageDiv = document.createElement('div');
                messageDiv.className = 'chat-message max-w-lg lg:max-w-xl p-4 flex items-start space-x-4';
                wrapper.appendChild(messageDiv);
            }

            const avatarDiv = document.createElement('div');
            avatarDiv.className = `avatar-wrapper ${isStreaming ? 'avatar-thinking' : ''}`;
            avatarDiv.innerHTML = avatar;

            const contentDiv = document.createElement('div');
            contentDiv.className = 'message-content';

            const { htmlContent, textContent, suggestions } = parseContent(content);
            contentDiv.innerHTML = `<div class="${role === 'user' ? 'text-white' : ''}">${htmlContent}</div>`;
            renderSuggestionChips(suggestions);

            messageDiv.innerHTML = ''; // Clear and rebuild
            if (role === 'assistant') {
                messageDiv.appendChild(avatarDiv);
                messageDiv.appendChild(contentDiv);
            } else {
                messageDiv.appendChild(contentDiv);
                messageDiv.appendChild(avatarDiv);
            }

            chatContainer.scrollTop = chatContainer.scrollHeight;
            return messageDiv;
        }

        function renderSuggestionChips(suggestions) {
            suggestionChipsContainer.innerHTML = '';
            if (suggestions && suggestions.length > 0) {
                suggestions.forEach(text => {
                    const button = document.createElement('button');
                    button.className = 'suggestion-chip';
                    button.textContent = text;
                    button.onclick = () => handleSuggestionClick(text);
                    suggestionChipsContainer.appendChild(button);
                });
            }
        }

        function handleSuggestionClick(text) {
            chatInput.value = text;
            chatForm.dispatchEvent(new Event('submit'));
        }

        async function getApiResponse(prompt) {
            suggestionChipsContainer.innerHTML = '';
            const messages = conversations[currentConversationId].messages;
            
            if (!apiKey || apiKey === "YOUR_API_KEY_HERE") {
                const errorMessage = { role: 'assistant', content: "Oh darling, it seems the API key is missing. Please ask the developer to add it. ðŸ’–" };
                messages.push(errorMessage);
                addMessageToUI(errorMessage);
                return;
            }

            let fullPrompt = `Context: ${documentContext}\n\n---\n\n${prompt}`;
            
            const API_URL = `https://generativelanguage.googleapis.com/v1beta/models/${modelName}:streamGenerateContent?key=${apiKey}`;
            const payload = {
                contents: [{ parts: [{ text: `${LOVELY_PERSONALITY}\n\nUser: ${fullPrompt}\nLovely:` }] }],
            };

            let responseText = "";
            let streamId = `stream-${Date.now()}`;
            addMessageToUI({ role: 'assistant', content: ""}, true, streamId);
            
            try {
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                
                const reader = response.body.getReader();
                const decoder = new TextDecoder();
                
                while (true) {
                    const { done, value } = await reader.read();
                    if (done) break;
                    
                    const chunk = decoder.decode(value);
                    const lines = chunk.split('\n');
                    for (const line of lines) {
                        if (line.startsWith('data: ')) {
                            const jsonStr = line.substring(6).trim();
                            if (jsonStr) {
                                const json = JSON.parse(jsonStr);
                                const textPart = json.candidates?.[0]?.content?.parts?.[0]?.text;
                                if (textPart) {
                                    responseText += textPart;
                                    addMessageToUI({ role: 'assistant', content: responseText }, true, streamId);
                                }
                            }
                        }
                    }
                }
                
            } catch (error) {
                console.error("API Error:", error);
                responseText = `Oh dear! ðŸ˜” I encountered a little hiccup. Could you please try asking again? ðŸ’•`;
            } finally {
                const finalMessage = { role: 'assistant', content: responseText };
                messages.push(finalMessage);
                addMessageToUI(finalMessage, false, streamId);
                saveConversations();
            }
        }
        
        function saveConversations() {
            localStorage.setItem('lovely-conversations', JSON.stringify(conversations));
            localStorage.setItem('lovely-current-conversation-id', currentConversationId);
        }

        function startNewChat() {
            const newId = `chat-${Date.now()}`;
            conversations[newId] = { id: newId, messages: [], title: "New Conversation", date: new Date().toISOString() };
            loadConversation(newId);
            saveConversations();
            renderHistory();
            sidebar.classList.remove('open');
        }

        function getRelativeTime(dateString) {
            const date = new Date(dateString);
            const now = new Date();
            const diffSeconds = Math.round((now - date) / 1000);
            const diffDays = Math.round(diffSeconds / (60 * 60 * 24));

            if (diffDays === 0) return "Today";
            if (diffDays === 1) return "Yesterday";
            return date.toLocaleDateString();
        }

        function loadConversation(id) {
            currentConversationId = id;
            chatContainer.innerHTML = '';
            welcomeMessage.classList.add('hidden');
            if(conversations[id].messages.length === 0){
                welcomeMessage.classList.remove('hidden');
                 const { htmlContent, suggestions } = parseContent(initialMessage.content);
                welcomeMessage.innerHTML = `<p class="text-xl mb-4">${htmlContent}</p>`;
                renderSuggestionChips(suggestions);
                subtitle.innerHTML = `Your Charming AI Companion <span id="rag-indicator" class="${conversations[id].ragContext ? 'visible' : ''}">ðŸ“„</span>`;
            } else {
                 conversations[id].messages.forEach(msg => addMessageToUI(msg));
                 const lastMessage = conversations[id].messages[conversations[id].messages.length - 1];
                 if(lastMessage.role === 'assistant') {
                    renderSuggestionChips(parseContent(lastMessage.content).suggestions);
                 }
                 subtitle.innerHTML = `${conversations[id].title} <span id="rag-indicator" class="${conversations[id].ragContext ? 'visible' : ''}">ðŸ“„</span>`;
            }
            renderHistory();
            ragContext.value = conversations[id].ragContext || "";
            documentContext = conversations[id].ragContext || "";
        }
        
        function renderHistory() {
            historyContainer.innerHTML = '';
            const sortedConversations = Object.values(conversations).sort((a,b) => new Date(b.date) - new Date(a.date));

            sortedConversations.forEach(conv => {
                const item = document.createElement('div');
                item.className = `history-item ${conv.id === currentConversationId ? 'active' : ''}`;
                const icon = 'ðŸ’¬';
                const title = conv.title === "New Conversation" && conv.messages.length > 0 ? conv.messages[0].content.substring(0, 25) + '...' : conv.title;
                const timestamp = getRelativeTime(conv.date);
                
                item.innerHTML = `<span class="icon">${icon}</span> <span>${title}</span> <span class="timestamp">${timestamp}</span>`;
                item.onclick = () => loadConversation(conv.id);
                historyContainer.appendChild(item);
            });
        }
        
        saveRagContext.addEventListener('click', () => {
            documentContext = ragContext.value;
            conversations[currentConversationId].ragContext = documentContext;
            document.getElementById('rag-indicator').classList.toggle('visible', !!documentContext);
            saveConversations();
            alert("Context saved for this conversation!");
        });

        function initializeApp() {
            if (!currentConversationId || !conversations[currentConversationId]) {
                startNewChat();
            } else {
                loadConversation(currentConversationId);
            }
        }

        settingsToggle.addEventListener('click', () => sidebar.classList.toggle('open'));
        newChatBtn.addEventListener('click', startNewChat);

        chatForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const userInput = chatInput.value.trim();
            if (!userInput) return;
            
            if (!welcomeMessage.classList.contains('hidden')) {
                welcomeMessage.classList.add('hidden');
            }
            
            const userMessage = { role: 'user', content: userInput };
            
            if(conversations[currentConversationId].messages.length === 0) {
                conversations[currentConversationId].title = userInput.substring(0, 30);
            }
            conversations[currentConversationId].messages.push(userMessage);
            
            addMessageToUI(userMessage);
            
            chatInput.value = '';
            
            getApiResponse(userInput);
            renderHistory();
        });
        
        document.body.addEventListener('mousemove', (e) => {
            cursorGlow.style.left = `${e.clientX}px`;
            cursorGlow.style.top = `${e.clientY}px`;
        });
        
        function createFirework() {
            const firework = document.createElement('div');
            firework.className = 'firework';
            firework.style.left = `${Math.random() * 100}vw`;
            firework.style.top = `${Math.random() * 100}vh`;
            fireworksContainer.appendChild(firework);

            const particleCount = 25;
            const colors = ['#ffc0cb', '#ff69b4', '#db7093', '#c71585', '#ffffff', '#e6e6fa'];

            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle-firework';
                const angle = Math.random() * 360;
                const radius = Math.random() * 60 + 20;
                const x = Math.cos(angle * (Math.PI / 180)) * radius;
                const y = Math.sin(angle * (Math.PI / 180)) * radius;

                particle.style.setProperty('--x', `${x}px`);
                particle.style.setProperty('--y', `${y}px`);
                particle.style.background = colors[Math.floor(Math.random() * colors.length)];
                particle.style.animationDelay = `${Math.random() * 0.2}s`;
                firework.appendChild(particle);
            }

            setTimeout(() => {
                firework.remove();
            }, 1500);
        }

        setInterval(createFirework, 1000);

        document.addEventListener('DOMContentLoaded', initializeApp);

    </script>
</body>
</html>